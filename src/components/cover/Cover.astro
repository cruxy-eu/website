---
import { Image } from "astro:assets"

interface CoverProps {
    img?: string;
    alt?: string;
    title?: string;
    overlay?: 'dark' | 'light' | 'none';
}

let {
    img = '',
    alt = '',
    title = '',
    overlay = 'none',
    ...props
}: CoverProps = Astro.props;
---

<div class="cover" {...props}>
    <Image
            src={img}
            alt={alt}
            title={title}
            fetchpriority="high"
    />
    {overlay && overlay !== 'none' && (
        <div class={`overlay ${overlay}`}>
        </div>
    )}
    <slot />
</div>

<style is:global>

    .cover {
        --image-index: -2;
        --overlay-index: -1;
        --content-index: 0;

        position: relative;
        container: cover inline-size;
        isolation: isolate;
        width: 100vw;
        height: 100vh;

        &:first-of-type {
            padding-top: var(--cruxy--header--height);
        }

        img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            object-fit: cover;
            z-index: var(--image-index);
        }

        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: var(--overlay-index);

            &.dark {
                background-color: rgba(125, 20, 30, 0.4);
            }

            &.light {
                background-color: rgba(255, 255, 255, 0.5);
            }

            &.none {
                background-color: transparent;
            }
        }
    }

</style>
